<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üèúÔ∏è Desert Tribe - Camel Racing</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Courier New', monospace;
      background: linear-gradient(to bottom, #f4a460 0%, #daa520 50%, #d2691e 100%);
      min-height: 100vh;
      overflow-x: hidden;
    }
    .container { max-width: 1400px; margin: 0 auto; padding: 20px; text-align: center; }
    .title {
      color: #fff;
      text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.5);
      margin: 40px 0;
      animation: fadeIn 1s ease-in;
    }
    .title h1 { font-size: 3em; letter-spacing: 3px; }
    .title p { font-size: 1.2em; color: #ffe4b5; margin-top: 10px; }
    .village {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin: 20px 0;
    }
    .tent {
      background: rgba(139, 69, 19, 0.6);
      border: 3px solid #654321;
      border-radius: 15px;
      padding: 30px;
      cursor: pointer;
      transition: all 0.3s;
      text-align: center;
    }
    .tent:hover {
      transform: translateY(-5px);
      background: rgba(139, 69, 19, 0.9);
      box-shadow: 0 10px 30px rgba(255, 215, 0, 0.3);
    }
    .tent h2 { color: #FFD700; font-size: 1.8em; margin-bottom: 10px; }
    .tent p { color: #FFF; font-size: 1em; }
    button {
      background: linear-gradient(45deg, #32CD32, #228B22);
      color: white;
      border: none;
      padding: 15px 40px;
      font-size: 1.2em;
      font-weight: bold;
      border-radius: 8px;
      cursor: pointer;
      margin: 10px;
    }
    button:hover { transform: scale(1.05); }

    /* Race View */
    .race-view {
      display: none;
      margin: 20px 0;
    }

    .main-track {
      width: 100%;
      height: 500px;
      border: 4px solid #654321;
      border-radius: 10px;
      margin: 20px 0;
      background: linear-gradient(to bottom, #87CEEB 0%, #F4A460 40%, #D2691E 100%);
      overflow: hidden;
      position: relative;
    }

    canvas {
      display: block;
    }

    /* Minimap */
    .minimap-container {
      width: 100%;
      height: 100px;
      background: rgba(0,0,0,0.8);
      border: 3px solid #FFD700;
      border-radius: 10px;
      padding: 10px;
      margin: 20px 0;
    }

    .minimap {
      width: 100%;
      height: 100%;
      background: linear-gradient(to right, #8B4513 0%, #D2691E 50%, #FFD700 100%);
      border-radius: 5px;
      position: relative;
      overflow: hidden;
    }

    .camel-dot {
      position: absolute;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      border: 2px solid #fff;
      top: 50%;
      transform: translateY(-50%);
      transition: left 0.1s linear;
    }

    .finish-line-mini {
      position: absolute;
      right: 0;
      top: 0;
      width: 3px;
      height: 100%;
      background: #FFD700;
    }

    /* Leaderboard */
    .leaderboard {
      background: rgba(0,0,0,0.7);
      border: 3px solid #FFD700;
      border-radius: 10px;
      padding: 20px;
      margin: 20px 0;
    }

    .leader-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      margin: 5px 0;
      background: rgba(139, 69, 19, 0.4);
      border-radius: 8px;
      border-left: 4px solid;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="title">
      <h1>üèúÔ∏è DESERT TRIBE üê™</h1>
      <p>Welcome to the Ancient Camel Racing Grounds</p>
    </div>

    <div class="village">
      <div class="tent" onclick="startRace()">
        <h2>Racing Arena</h2>
        <p>Epic 10km desert race!</p>
      </div>
      <div class="tent">
        <h2>Camel Stable</h2>
        <p>Meet the camels</p>
      </div>
      <div class="tent">
        <h2>Betting Tent</h2>
        <p>Place your bets</p>
      </div>
      <div class="tent">
        <h2>Trader's Market</h2>
        <p>Buy gear</p>
      </div>
    </div>

    <div class="race-view" id="raceView">
      <h2 style="color: #FFD700; font-size: 2em; margin-bottom: 20px;">üèÅ 10KM EPIC RACE üèÅ</h2>

      <!-- Main Track View -->
      <div class="main-track">
        <canvas id="raceCanvas" width="1400" height="500"></canvas>
      </div>

      <!-- Minimap -->
      <div class="minimap-container">
        <h3 style="color: #FFD700; margin-bottom: 10px;">üìç RACE PROGRESS</h3>
        <div class="minimap" id="minimap">
          <div class="finish-line-mini"></div>
        </div>
      </div>

      <!-- Live Leaderboard -->
      <div class="leaderboard">
        <h3 style="color: #FFD700; font-size: 1.5em; margin-bottom: 15px;">üèÜ LIVE STANDINGS</h3>
        <div id="leaderboard"></div>
      </div>

      <div id="raceStatus" style="color: #32CD32; font-size: 1.5em; margin: 20px 0;"></div>
      <button onclick="location.reload()" style="display: none;" id="resetBtn">üîÑ NEW RACE</button>
    </div>
  </div>

  <script>
    const CAMELS = [
      { id: 0, name: 'Desert Storm', baseSpeed: 3.5, color: '#8B4513', jockey: 'üë≥' },
      { id: 1, name: 'Sand Runner', baseSpeed: 3.2, color: '#D2691E', jockey: 'üßî' },
      { id: 2, name: 'Golden Wind', baseSpeed: 3.8, color: '#DAA520', jockey: 'üë®' },
      { id: 3, name: 'Oasis King', baseSpeed: 3.3, color: '#CD853F', jockey: 'üßë' },
      { id: 4, name: 'Dune Dancer', baseSpeed: 3.6, color: '#DEB887', jockey: 'üë¥' },
      { id: 5, name: 'Mirage Master', baseSpeed: 3.9, color: '#F4A460', jockey: 'üßì' },
      { id: 6, name: 'Swift Sands', baseSpeed: 3.4, color: '#BC8F8F', jockey: 'üë≤' },
      { id: 7, name: 'Thunder Hoof', baseSpeed: 3.1, color: '#A0522D', jockey: 'üßï' },
      { id: 8, name: 'Lightning Bolt', baseSpeed: 4.0, color: '#D2B48C', jockey: 'üë±' }
    ];

    const RaceEngine = {
      canvas: null,
      ctx: null,
      camels: [],
      raceInProgress: false,
      winner: null,
      raceLength: 10000,
      viewportX: 0,

      init() {
        this.canvas = document.getElementById('raceCanvas');
        this.ctx = this.canvas.getContext('2d');

        this.camels = CAMELS.map((c, i) => ({
          ...c,
          x: 0,
          y: 50 + (i * 50),
          speed: c.baseSpeed,
          stamina: 100,
          distance: 0,
          lane: i
        }));

        this.drawScene();
      },

      drawScene() {
        const ctx = this.ctx;
        const canvas = this.canvas;

        // CLEAR CANVAS - NO STREAKS!
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Sky
        const gradient = ctx.createLinearGradient(0, 0, 0, 150);
        gradient.addColorStop(0, '#87CEEB');
        gradient.addColorStop(1, '#F4A460');
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, canvas.width, 150);

        // Sun
        ctx.fillStyle = '#FFD700';
        ctx.beginPath();
        ctx.arc(200, 60, 40, 0, Math.PI * 2);
        ctx.fill();

        // Sand ground
        ctx.fillStyle = '#D2691E';
        ctx.fillRect(0, 150, canvas.width, canvas.height - 150);

        // Racing lanes
        ctx.strokeStyle = 'rgba(139, 69, 19, 0.3)';
        ctx.lineWidth = 2;
        for (let i = 0; i < 10; i++) {
          ctx.beginPath();
          ctx.moveTo(0, i * 50);
          ctx.lineTo(canvas.width, i * 50);
          ctx.stroke();
        }

        // Distance markers
        const scale = canvas.width / this.raceLength;
        ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
        ctx.font = '14px Courier';
        for (let i = 0; i <= 10; i++) {
          const x = (i * 1000) * scale;
          ctx.fillRect(x, 0, 2, canvas.height);
          ctx.fillStyle = '#FFD700';
          ctx.fillText(`${i}km`, x + 5, 170);
          ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
        }

        // Finish line
        ctx.fillStyle = '#000';
        const finishX = canvas.width - 50;
        ctx.fillRect(finishX, 0, 50, canvas.height);
        for (let i = 0; i < 10; i++) {
          for (let j = 0; j < 2; j++) {
            if ((i + j) % 2 === 0) {
              ctx.fillStyle = '#fff';
              ctx.fillRect(finishX + (j * 25), i * 50, 25, 50);
            }
          }
        }
      },

      drawCamel(camel) {
        const ctx = this.ctx;
        const scale = this.canvas.width / this.raceLength;
        const x = camel.distance * scale;
        const y = camel.y;

        // Camel body
        ctx.fillStyle = camel.color;
        ctx.fillRect(x, y, 40, 30);
        ctx.fillRect(x + 32, y - 12, 14, 20);

        // Humps
        ctx.beginPath();
        ctx.arc(x + 15, y + 3, 10, Math.PI, 0);
        ctx.fill();
        ctx.beginPath();
        ctx.arc(x + 28, y + 3, 8, Math.PI, 0);
        ctx.fill();

        // Legs
        ctx.fillRect(x + 8, y + 30, 4, 12);
        ctx.fillRect(x + 18, y + 30, 4, 12);
        ctx.fillRect(x + 28, y + 30, 4, 12);
        ctx.fillRect(x + 38, y + 30, 4, 12);

        // Jockey
        ctx.font = '20px Arial';
        ctx.fillText(camel.jockey, x + 15, y + 18);

        // Name tag
        ctx.fillStyle = '#000';
        ctx.font = 'bold 10px Courier';
        ctx.fillText(camel.name, x - 5, y - 5);
      },

      updateMinimap() {
        const minimap = document.getElementById('minimap');

        // Clear existing dots
        minimap.querySelectorAll('.camel-dot').forEach(dot => dot.remove());

        // Add camel dots
        this.camels.forEach(camel => {
          const dot = document.createElement('div');
          dot.className = 'camel-dot';
          dot.style.backgroundColor = camel.color;
          dot.style.left = ((camel.distance / this.raceLength) * 100) + '%';
          dot.title = camel.name;
          minimap.appendChild(dot);
        });
      },

      updateLeaderboard() {
        const sorted = [...this.camels].sort((a, b) => b.distance - a.distance);
        const div = document.getElementById('leaderboard');

        div.innerHTML = sorted.map((camel, i) => {
          const progress = ((camel.distance / this.raceLength) * 100).toFixed(1);
          const medal = i === 0 ? 'ü•á' : i === 1 ? 'ü•à' : i === 2 ? 'ü•â' : `${i + 1}.`;

          return `
            <div class="leader-item" style="border-left-color: ${camel.color};">
              <div>
                <span style="font-size: 1.3em; margin-right: 10px;">${medal}</span>
                <strong style="color: #FFD700;">${camel.jockey} ${camel.name}</strong>
              </div>
              <div style="color: #32CD32; font-weight: bold;">${progress}%</div>
            </div>
          `;
        }).join('');
      },

      startRace() {
        this.raceInProgress = true;
        document.getElementById('raceStatus').textContent = 'üèÅ RACE IN PROGRESS!';
        this.animate();
      },

      animate() {
        if (!this.raceInProgress) return;

        // Redraw scene
        this.drawScene();

        let raceFinished = false;

        // Update and draw camels
        this.camels.forEach(camel => {
          // Speed calculation
          camel.speed = camel.baseSpeed + (Math.random() - 0.5) * 1.5;

          // Stamina
          camel.stamina -= 0.05;
          if (camel.stamina < 70) camel.speed *= 0.97;
          if (camel.stamina < 40) camel.speed *= 0.93;
          if (camel.stamina < 20) camel.speed *= 0.88;

          // Random bursts
          if (Math.random() > 0.985) camel.speed *= 1.8;

          // Move forward
          camel.distance += camel.speed;

          // Small vertical wobble
          camel.y = 50 + (camel.lane * 50) + Math.sin(camel.distance * 0.1) * 3;

          // Draw camel
          this.drawCamel(camel);

          // Check finish
          if (camel.distance >= this.raceLength && !this.winner) {
            this.winner = camel;
            raceFinished = true;
          }
        });

        // Update UI
        this.updateMinimap();
        this.updateLeaderboard();

        if (raceFinished) {
          this.finishRace();
        } else {
          requestAnimationFrame(() => this.animate());
        }
      },

      finishRace() {
        this.raceInProgress = false;

        document.getElementById('raceStatus').innerHTML = `
          üèÜ <span style="color: #FFD700; font-size: 1.3em;">${this.winner.name}</span> WINS! üèÜ<br>
          <span style="font-size: 0.9em;">Jockey: ${this.winner.jockey} | Time: ${(this.raceLength / this.winner.speed).toFixed(1)}s</span>
        `;

        document.getElementById('resetBtn').style.display = 'block';
      }
    };

    function startRace() {
      document.querySelector('.village').style.display = 'none';
      document.querySelector('.title').style.display = 'none';
      document.getElementById('raceView').style.display = 'block';

      RaceEngine.init();
      setTimeout(() => RaceEngine.startRace(), 1000);
    }
  </script>
</body>
</html>

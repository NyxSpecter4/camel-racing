<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸœï¸ Desert Tribe - Camel Racing</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Courier New', monospace;
      background: linear-gradient(to bottom, #f4a460 0%, #daa520 50%, #d2691e 100%);
      min-height: 100vh;
      overflow-x: hidden;
    }
    .container { max-width: 1400px; margin: 0 auto; padding: 20px; text-align: center; }
    .title {
      color: #fff;
      text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.5);
      margin: 40px 0;
      animation: fadeIn 1s ease-in;
    }
    .title h1 { font-size: 3em; letter-spacing: 3px; }
    .title p { font-size: 1.2em; color: #ffe4b5; margin-top: 10px; }
    .village {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin: 20px 0;
    }
    .tent {
      background: rgba(139, 69, 19, 0.6);
      border: 3px solid #654321;
      border-radius: 15px;
      padding: 30px;
      cursor: pointer;
      transition: all 0.3s;
      text-align: center;
    }
    .tent:hover {
      transform: translateY(-5px);
      background: rgba(139, 69, 19, 0.9);
      box-shadow: 0 10px 30px rgba(255, 215, 0, 0.3);
    }
    .tent h2 { color: #FFD700; font-size: 1.8em; margin-bottom: 10px; }
    .tent p { color: #FFF; font-size: 1em; }
    button {
      background: linear-gradient(45deg, #32CD32, #228B22);
      color: white;
      border: none;
      padding: 15px 40px;
      font-size: 1.2em;
      font-weight: bold;
      border-radius: 8px;
      cursor: pointer;
      margin: 10px;
    }
    button:hover { transform: scale(1.05); }

    .race-view {
      display: none;
      margin: 20px 0;
    }

    .main-track {
      width: 100%;
      height: 500px;
      border: 4px solid #654321;
      border-radius: 10px;
      margin: 20px 0;
      background: linear-gradient(to bottom, #87CEEB 0%, #F4A460 40%, #D2691E 100%);
      overflow: hidden;
      position: relative;
    }

    canvas {
      display: block;
    }

    .minimap-container {
      width: 100%;
      height: 100px;
      background: rgba(0,0,0,0.8);
      border: 3px solid #FFD700;
      border-radius: 10px;
      padding: 10px;
      margin: 20px 0;
    }

    .minimap {
      width: 100%;
      height: 100%;
      background: linear-gradient(to right, #8B4513 0%, #D2691E 50%, #FFD700 100%);
      border-radius: 5px;
      position: relative;
      overflow: hidden;
    }

    .camel-dot {
      position: absolute;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      border: 2px solid #fff;
      top: 50%;
      transform: translateY(-50%);
      transition: left 0.1s linear;
    }

    .finish-line-mini {
      position: absolute;
      right: 0;
      top: 0;
      width: 3px;
      height: 100%;
      background: #FFD700;
    }

    .leaderboard {
      background: rgba(0,0,0,0.7);
      border: 3px solid #FFD700;
      border-radius: 10px;
      padding: 20px;
      margin: 20px 0;
    }

    .leader-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      margin: 5px 0;
      background: rgba(139, 69, 19, 0.4);
      border-radius: 8px;
      border-left: 4px solid;
    }

    .race-conditions {
      background: rgba(0,0,0,0.7);
      border: 2px solid #FFD700;
      border-radius: 10px;
      padding: 15px;
      margin: 15px 0;
      color: #FFD700;
      font-size: 0.9em;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="title">
      <h1>ğŸœï¸ DESERT TRIBE ğŸª</h1>
      <p>Welcome to the Ancient Camel Racing Grounds</p>
    </div>

    <div class="village">
      <div class="tent" onclick="startRace()">
        <h2>Racing Arena</h2>
        <p>Epic 10km desert race!</p>
      </div>
      <div class="tent">
        <h2>Camel Stable</h2>
        <p>Meet the camels</p>
      </div>
      <div class="tent">
        <h2>Betting Tent</h2>
        <p>Place your bets</p>
      </div>
      <div class="tent">
        <h2>Trader's Market</h2>
        <p>Buy gear</p>
      </div>
    </div>

    <div class="race-view" id="raceView">
      <h2 style="color: #FFD700; font-size: 2em; margin-bottom: 20px;">ğŸ 10KM EPIC RACE ğŸ</h2>

      <div class="race-conditions" id="raceConditions"></div>

      <div class="main-track">
        <canvas id="raceCanvas" width="1400" height="500"></canvas>
      </div>

      <div class="minimap-container">
        <h3 style="color: #FFD700; margin-bottom: 10px;">ğŸ“ RACE PROGRESS</h3>
        <div class="minimap" id="minimap">
          <div class="finish-line-mini"></div>
        </div>
      </div>

      <div class="leaderboard">
        <h3 style="color: #FFD700; font-size: 1.5em; margin-bottom: 15px;">ğŸ† LIVE STANDINGS</h3>
        <div id="leaderboard"></div>
      </div>

      <div id="raceStatus" style="color: #32CD32; font-size: 1.5em; margin: 20px 0;"></div>
      <button onclick="location.reload()" style="display: none;" id="resetBtn">ğŸ”„ NEW RACE</button>
    </div>
  </div>

  <script>
    // ALL CAMELS SAME BASE SPEED!
    const CAMELS = [
      { id: 0, name: 'Desert Storm', color: '#8B4513', jockey: 'ğŸ‘³' },
      { id: 1, name: 'Sand Runner', color: '#D2691E', jockey: 'ğŸ§”' },
      { id: 2, name: 'Golden Wind', color: '#DAA520', jockey: 'ğŸ‘¨' },
      { id: 3, name: 'Oasis King', color: '#CD853F', jockey: 'ğŸ§‘' },
      { id: 4, name: 'Dune Dancer', color: '#DEB887', jockey: 'ğŸ‘´' },
      { id: 5, name: 'Mirage Master', color: '#F4A460', jockey: 'ğŸ§“' },
      { id: 6, name: 'Swift Sands', color: '#BC8F8F', jockey: 'ğŸ‘²' },
      { id: 7, name: 'Thunder Hoof', color: '#A0522D', jockey: 'ğŸ§•' },
      { id: 8, name: 'Lightning Bolt', color: '#D2B48C', jockey: 'ğŸ‘±' }
    ];

    const RaceEngine = {
      canvas: null,
      ctx: null,
      camels: [],
      raceInProgress: false,
      winner: null,
      raceLength: 10000,
      weather: null,
      terrain: null,

      init() {
        this.canvas = document.getElementById('raceCanvas');
        this.ctx = this.canvas.getContext('2d');

        // Random race conditions
        this.weather = this.getRandomWeather();
        this.terrain = this.getRandomTerrain();

        // Show conditions
        document.getElementById('raceConditions').innerHTML = `
          ğŸŒ¡ï¸ Weather: <strong>${this.weather.name}</strong> |
          ğŸœï¸ Terrain: <strong>${this.terrain.name}</strong>
        `;

        // Initialize camels with SAME base speed but different random factors
        this.camels = CAMELS.map((c, i) => ({
          ...c,
          x: 0,
          y: 50 + (i * 50),

          // BASE SPEED - ALL SAME!
          baseSpeed: 3.5,

          // RANDOM FACTORS FOR THIS RACE
          todaysForm: 0.85 + Math.random() * 0.3, // 0.85 - 1.15 (how good they feel today)
          maxStamina: 80 + Math.random() * 40, // 80-120 (some have better endurance)
          staminaDrain: 0.04 + Math.random() * 0.03, // 0.04-0.07 (how fast they tire)
          recoveryRate: 0.02 + Math.random() * 0.03, // 0.02-0.05 (how fast they recover)
          consistency: 0.7 + Math.random() * 0.6, // 0.7-1.3 (consistent vs volatile)
          burstChance: 0.01 + Math.random() * 0.02, // 0.01-0.03 (chance of speed burst)
          stumbleChance: 0.005 + Math.random() * 0.01, // 0.005-0.015 (bad luck)
          weatherPreference: Math.random(), // how much they like this weather
          terrainPreference: Math.random(), // how much they like this terrain
          startingReaction: 0.9 + Math.random() * 0.2, // 0.9-1.1 (start speed)

          // Current state
          stamina: 100,
          speed: 3.5,
          distance: 0,
          lane: i,
          isStumbling: false,
          stumbleTimer: 0,
          burstTimer: 0
        }));

        this.drawScene();
      },

      getRandomWeather() {
        const weathers = [
          { name: 'Clear Skies â˜€ï¸', multiplier: 1.0 },
          { name: 'Windy ğŸ’¨', multiplier: 0.95 },
          { name: 'Hot Day ğŸ”¥', multiplier: 0.92 },
          { name: 'Cool Morning ğŸŒ¤ï¸', multiplier: 1.05 },
          { name: 'Sandstorm ğŸŒªï¸', multiplier: 0.85 }
        ];
        return weathers[Math.floor(Math.random() * weathers.length)];
      },

      getRandomTerrain() {
        const terrains = [
          { name: 'Soft Sand ğŸ–ï¸', multiplier: 0.95 },
          { name: 'Hard Packed ğŸª¨', multiplier: 1.05 },
          { name: 'Mixed Dunes ğŸœï¸', multiplier: 1.0 },
          { name: 'Rocky Path â›°ï¸', multiplier: 0.9 },
          { name: 'Smooth Track ğŸ›¤ï¸', multiplier: 1.08 }
        ];
        return terrains[Math.floor(Math.random() * terrains.length)];
      },

      drawScene() {
        const ctx = this.ctx;
        const canvas = this.canvas;

        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Sky
        const gradient = ctx.createLinearGradient(0, 0, 0, 150);
        gradient.addColorStop(0, '#87CEEB');
        gradient.addColorStop(1, '#F4A460');
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, canvas.width, 150);

        // Sun
        ctx.fillStyle = '#FFD700';
        ctx.beginPath();
        ctx.arc(200, 60, 40, 0, Math.PI * 2);
        ctx.fill();

        // Sand ground
        ctx.fillStyle = '#D2691E';
        ctx.fillRect(0, 150, canvas.width, canvas.height - 150);

        // Racing lanes
        ctx.strokeStyle = 'rgba(139, 69, 19, 0.3)';
        ctx.lineWidth = 2;
        for (let i = 0; i < 10; i++) {
          ctx.beginPath();
          ctx.moveTo(0, i * 50);
          ctx.lineTo(canvas.width, i * 50);
          ctx.stroke();
        }

        // Distance markers
        const scale = canvas.width / this.raceLength;
        ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
        ctx.font = '14px Courier';
        for (let i = 0; i <= 10; i++) {
          const x = (i * 1000) * scale;
          ctx.fillRect(x, 0, 2, canvas.height);
          ctx.fillStyle = '#FFD700';
          ctx.fillText(`${i}km`, x + 5, 170);
          ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
        }

        // Finish line
        ctx.fillStyle = '#000';
        const finishX = canvas.width - 50;
        ctx.fillRect(finishX, 0, 50, canvas.height);
        for (let i = 0; i < 10; i++) {
          for (let j = 0; j < 2; j++) {
            if ((i + j) % 2 === 0) {
              ctx.fillStyle = '#fff';
              ctx.fillRect(finishX + (j * 25), i * 50, 25, 50);
            }
          }
        }
      },

      drawCamel(camel) {
        const ctx = this.ctx;
        const scale = this.canvas.width / this.raceLength;
        const x = camel.distance * scale;
        const y = camel.y;

        // Stumble effect
        const wobble = camel.isStumbling ? Math.sin(Date.now() * 0.1) * 5 : 0;

        // Camel body
        ctx.fillStyle = camel.color;
        ctx.fillRect(x, y + wobble, 40, 30);
        ctx.fillRect(x + 32, y - 12 + wobble, 14, 20);

        // Humps
        ctx.beginPath();
        ctx.arc(x + 15, y + 3 + wobble, 10, Math.PI, 0);
        ctx.fill();
        ctx.beginPath();
        ctx.arc(x + 28, y + 3 + wobble, 8, Math.PI, 0);
        ctx.fill();

        // Legs
        ctx.fillRect(x + 8, y + 30 + wobble, 4, 12);
        ctx.fillRect(x + 18, y + 30 + wobble, 4, 12);
        ctx.fillRect(x + 28, y + 30 + wobble, 4, 12);
        ctx.fillRect(x + 38, y + 30 + wobble, 4, 12);

        // Jockey
        ctx.font = '20px Arial';
        ctx.fillText(camel.jockey, x + 15, y + 18 + wobble);

        // Name and status
        ctx.fillStyle = '#000';
        ctx.font = 'bold 10px Courier';
        ctx.fillText(camel.name, x - 5, y - 5);

        // Status indicators
        if (camel.burstTimer > 0) {
          ctx.fillStyle = '#FFD700';
          ctx.fillText('âš¡BURST!', x - 5, y - 15);
        }
        if (camel.isStumbling) {
          ctx.fillStyle = '#FF0000';
          ctx.fillText('ğŸ’«STUMBLE', x - 5, y - 15);
        }
      },

      updateMinimap() {
        const minimap = document.getElementById('minimap');
        minimap.querySelectorAll('.camel-dot').forEach(dot => dot.remove());

        this.camels.forEach(camel => {
          const dot = document.createElement('div');
          dot.className = 'camel-dot';
          dot.style.backgroundColor = camel.color;
          dot.style.left = ((camel.distance / this.raceLength) * 100) + '%';
          dot.title = camel.name;
          minimap.appendChild(dot);
        });
      },

      updateLeaderboard() {
        const sorted = [...this.camels].sort((a, b) => b.distance - a.distance);
        const div = document.getElementById('leaderboard');

        div.innerHTML = sorted.map((camel, i) => {
          const progress = ((camel.distance / this.raceLength) * 100).toFixed(1);
          const medal = i === 0 ? 'ğŸ¥‡' : i === 1 ? 'ğŸ¥ˆ' : i === 2 ? 'ğŸ¥‰' : `${i + 1}.`;

          let status = '';
          if (camel.burstTimer > 0) status = 'âš¡';
          if (camel.isStumbling) status = 'ğŸ’«';
          if (camel.stamina < 30) status = 'ğŸ˜“';

          return `
            <div class="leader-item" style="border-left-color: ${camel.color};">
              <div>
                <span style="font-size: 1.3em; margin-right: 10px;">${medal}</span>
                <strong style="color: #FFD700;">${camel.jockey} ${camel.name}</strong>
                <span style="margin-left: 10px;">${status}</span>
              </div>
              <div style="color: #32CD32; font-weight: bold;">${progress}%</div>
            </div>
          `;
        }).join('');
      },

      startRace() {
        this.raceInProgress = true;
        document.getElementById('raceStatus').textContent = 'ğŸ RACE IN PROGRESS!';
        this.animate();
      },

      animate() {
        if (!this.raceInProgress) return;

        this.drawScene();

        let raceFinished = false;

        this.camels.forEach(camel => {
          // Calculate speed with ALL factors
          let speedMultiplier = 1.0;

          // Today's form (biggest factor)
          speedMultiplier *= camel.todaysForm;

          // Starting reaction (first 1000m)
          if (camel.distance < 1000) {
            speedMultiplier *= camel.startingReaction;
          }

          // Weather effect
          const weatherFit = 0.8 + (camel.weatherPreference * 0.4);
          speedMultiplier *= (weatherFit * this.weather.multiplier);

          // Terrain effect
          const terrainFit = 0.8 + (camel.terrainPreference * 0.4);
          speedMultiplier *= (terrainFit * this.terrain.multiplier);

          // Stamina effect (gets worse as stamina drops)
          const staminaFactor = Math.max(0.6, camel.stamina / 100);
          speedMultiplier *= staminaFactor;

          // Random variation (consistency factor)
          const randomness = (Math.random() - 0.5) * (2 - camel.consistency);
          speedMultiplier *= (1 + randomness * 0.15);

          // Speed burst!
          if (Math.random() < camel.burstChance && camel.burstTimer === 0) {
            camel.burstTimer = 60; // 60 frames of burst
          }
          if (camel.burstTimer > 0) {
            speedMultiplier *= 1.5;
            camel.burstTimer--;
          }

          // Stumble!
          if (Math.random() < camel.stumbleChance && !camel.isStumbling) {
            camel.isStumbling = true;
            camel.stumbleTimer = 40; // 40 frames of stumble
          }
          if (camel.isStumbling) {
            speedMultiplier *= 0.3;
            camel.stumbleTimer--;
            if (camel.stumbleTimer <= 0) {
              camel.isStumbling = false;
            }
          }

          // Apply speed
          camel.speed = camel.baseSpeed * speedMultiplier;

          // Stamina drain
          camel.stamina -= camel.staminaDrain;

          // Stamina recovery (if high stamina)
          if (camel.stamina < camel.maxStamina) {
            camel.stamina += camel.recoveryRate;
          }

          camel.stamina = Math.max(0, Math.min(camel.maxStamina, camel.stamina));

          // Move forward
          camel.distance += camel.speed;

          // Wobble
          camel.y = 50 + (camel.lane * 50) + Math.sin(camel.distance * 0.1) * 3;

          this.drawCamel(camel);

          if (camel.distance >= this.raceLength && !this.winner) {
            this.winner = camel;
            raceFinished = true;
          }
        });

        this.updateMinimap();
        this.updateLeaderboard();

        if (raceFinished) {
          this.finishRace();
        } else {
          requestAnimationFrame(() => this.animate());
        }
      },

      finishRace() {
        this.raceInProgress = false;

        document.getElementById('raceStatus').innerHTML = `
          ğŸ† <span style="color: #FFD700; font-size: 1.3em;">${this.winner.name}</span> WINS! ğŸ†<br>
          <span style="font-size: 0.9em;">Jockey: ${this.winner.jockey}</span><br>
          <span style="font-size: 0.8em; color: #aaa;">
            Form: ${(this.winner.todaysForm * 100).toFixed(0)}% |
            Final Stamina: ${this.winner.stamina.toFixed(0)}%
          </span>
        `;

        document.getElementById('resetBtn').style.display = 'block';
      }
    };

    function startRace() {
      document.querySelector('.village').style.display = 'none';
      document.querySelector('.title').style.display = 'none';
      document.getElementById('raceView').style.display = 'block';

      RaceEngine.init();
      setTimeout(() => RaceEngine.startRace(), 1000);
    }
  </script>
</body>
</html>

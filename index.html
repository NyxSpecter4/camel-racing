<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸœï¸ Desert Tribe - Camel Racing</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Courier New', monospace;
      background: linear-gradient(to bottom, #f4a460 0%, #daa520 50%, #d2691e 100%);
      min-height: 100vh;
      overflow-x: hidden;
    }
    .container { max-width: 1400px; margin: 0 auto; padding: 20px; text-align: center; }
    .title {
      color: #fff;
      text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.5);
      margin: 40px 0;
      animation: fadeIn 1s ease-in;
    }
    .title h1 { font-size: 3em; letter-spacing: 3px; }
    .title p { font-size: 1.2em; color: #ffe4b5; margin-top: 10px; }
    .village {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 30px;
      margin: 60px auto;
    }
    .tent {
      background: rgba(139, 69, 19, 0.8);
      border: 3px solid #654321;
      border-radius: 15px;
      padding: 30px 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
      min-height: 200px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .tent:hover {
      transform: translateY(-10px) scale(1.05);
      background: rgba(139, 69, 19, 0.95);
    }
    .tent::before {
      content: 'â›º';
      font-size: 4em;
      display: block;
      margin-bottom: 10px;
    }
    .tent h2 {
      color: #ffe4b5;
      font-size: 1.5em;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }
    .tent p { color: #ffd700; font-size: 0.9em; }
    .game-screen {
      display: none;
      background: rgba(0, 0, 0, 0.8);
      border: 4px solid #654321;
      border-radius: 15px;
      padding: 30px;
      margin: 20px auto;
      max-width: 1300px;
      min-height: 500px;
      color: #fff;
    }
    .game-screen.active { display: block; }
    .game-screen h2 {
      color: #ffd700;
      font-size: 2em;
      margin-bottom: 20px;
      text-align: center;
    }
    .back-button {
      background: linear-gradient(45deg, #8B4513, #654321);
      color: #fff;
      border: none;
      padding: 12px 24px;
      font-size: 1em;
      font-weight: bold;
      border-radius: 8px;
      cursor: pointer;
      margin-bottom: 20px;
    }
    .back-button:hover { transform: scale(1.05); }
    button {
      background: linear-gradient(45deg, #32CD32, #228B22);
      color: white;
      border: none;
      padding: 15px 40px;
      font-size: 1.2em;
      font-weight: bold;
      border-radius: 8px;
      cursor: pointer;
      margin: 10px;
    }
    button:hover { transform: scale(1.05); }
    canvas {
      background: #f0e68c;
      border: 4px solid #654321;
      border-radius: 10px;
      display: block;
      margin: 20px auto;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }
    #raceStatus {
      color: #FFD700;
      font-size: 1.3em;
      font-weight: bold;
      margin: 20px 0;
      padding: 15px;
      background: rgba(0,0,0,0.5);
      border-radius: 8px;
      min-height: 50px;
    }
    .map-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      margin: 30px 0;
    }
    .location-card {
      background: rgba(139, 69, 19, 0.6);
      border: 3px solid #654321;
      border-radius: 10px;
      padding: 20px;
      cursor: pointer;
      transition: all 0.3s;
    }
    .location-card:hover {
      transform: scale(1.05);
      background: rgba(139, 69, 19, 0.9);
    }
    .location-card h3 {
      color: #FFD700;
      font-size: 1.5em;
      margin-bottom: 10px;
    }
    .location-card p {
      color: #FFF;
      font-size: 0.9em;
    }
    .location-card.selected {
      border-color: #32CD32;
      box-shadow: 0 0 20px #32CD32;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="title">
      <h1>ğŸœï¸ DESERT TRIBE ğŸª</h1>
      <p>Welcome to the Ancient Camel Racing Grounds</p>
    </div>

    <div id="village" class="village">
      <div class="tent" onclick="enterTent('racing')">
        <h2>Racing Arena</h2>
        <p>Watch 9 camels race!</p>
      </div>
      <div class="tent" onclick="enterTent('stable')">
        <h2>Camel Stable</h2>
        <p>Meet your 9 camels</p>
      </div>
      <div class="tent" onclick="enterTent('map')">
        <h2>World Map</h2>
        <p>Choose racing location</p>
      </div>
      <div class="tent" onclick="enterTent('betting')">
        <h2>Betting Tent</h2>
        <p>Place your bets</p>
      </div>
      <div class="tent" onclick="enterTent('market')">
        <h2>Trader's Market</h2>
        <p>Buy gear</p>
      </div>
    </div>

    <div id="screen-racing" class="game-screen">
      <button class="back-button" onclick="returnToVillage()">â† Back to Village</button>
      <h2>ğŸ Racing Arena ğŸ</h2>
      <p id="trackName" style="color: #32CD32; font-size: 1.2em; margin-bottom: 10px;">ğŸ“ Arabian Sands</p>
      <canvas id="raceCanvas" width="1200" height="1100"></canvas>
      <div>
        <button onclick="startRace()">ğŸ START RACE</button>
        <button onclick="resetRace()" style="background: linear-gradient(45deg, #FF6347, #DC143C);">ğŸ”„ RESET</button>
      </div>
      <div id="raceStatus">Click START RACE to begin!</div>
    </div>

    <div id="screen-stable" class="game-screen">
      <button class="back-button" onclick="returnToVillage()">â† Back to Village</button>
      <h2>ğŸª Camel Stable ğŸª</h2>
      <div id="camelList" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;"></div>
    </div>

    <div id="screen-map" class="game-screen">
      <button class="back-button" onclick="returnToVillage()">â† Back to Village</button>
      <h2>ğŸ—ºï¸ World Map ğŸ—ºï¸</h2>
      <p style="color: #FFD700; margin-bottom: 20px;">Choose your racing location:</p>
      <div class="map-grid">
        <div class="location-card selected" onclick="selectLocation('arabian', this)">
          <h3>ğŸœï¸ Arabian Sands</h3>
          <p>Golden dunes with cacti</p>
          <p style="color: #32CD32; margin-top: 10px;">âœ“ Current Location</p>
        </div>
        <div class="location-card" onclick="selectLocation('egyptian', this)">
          <h3>ğŸ›ï¸ Egyptian Pyramids</h3>
          <p>Stone paths & ancient ruins</p>
        </div>
        <div class="location-card" onclick="selectLocation('sahara', this)">
          <h3>ğŸŒ… Sahara Sunset</h3>
          <p>Red desert with rock formations</p>
        </div>
      </div>
    </div>

    <div id="screen-betting" class="game-screen">
      <button class="back-button" onclick="returnToVillage()">â† Back to Village</button>
      <h2>ğŸ’° Betting Tent ğŸ’°</h2>
      <p style="color: #ffd700;">Coming soon! Place bets and win big!</p>
    </div>

    <div id="screen-market" class="game-screen">
      <button class="back-button" onclick="returnToVillage()">â† Back to Village</button>
      <h2>ğŸ›’ Trader's Market ğŸ›’</h2>
      <p style="color: #ffd700;">Coming soon! Buy gear and upgrades!</p>
    </div>
  </div>

  <script>
    const RaceEngine = {
      canvas: null,
      ctx: null,
      currentTrack: 'arabian',
      obstacles: [],
      camels: [
        { id: 0, name: 'Desert Storm', x: 50, y: 80, speed: 0, baseSpeed: 2.8, stamina: 100, color: '#8B4513', jockey: 'ğŸ‘³', stats: { wins: 0, races: 0 } },
        { id: 1, name: 'Sand Runner', x: 50, y: 200, speed: 0, baseSpeed: 2.5, stamina: 100, color: '#D2691E', jockey: 'ğŸ§”', stats: { wins: 0, races: 0 } },
        { id: 2, name: 'Golden Wind', x: 50, y: 320, speed: 0, baseSpeed: 3.0, stamina: 100, color: '#DAA520', jockey: 'ğŸ‘¨', stats: { wins: 0, races: 0 } },
        { id: 3, name: 'Oasis King', x: 50, y: 440, speed: 0, baseSpeed: 2.6, stamina: 100, color: '#CD853F', jockey: 'ğŸ§‘', stats: { wins: 0, races: 0 } },
        { id: 4, name: 'Dune Dancer', x: 50, y: 560, speed: 0, baseSpeed: 2.9, stamina: 100, color: '#DEB887', jockey: 'ğŸ‘´', stats: { wins: 0, races: 0 } },
        { id: 5, name: 'Mirage Master', x: 50, y: 680, speed: 0, baseSpeed: 3.1, stamina: 100, color: '#F4A460', jockey: 'ğŸ§“', stats: { wins: 0, races: 0 } },
        { id: 6, name: 'Swift Sands', x: 50, y: 800, speed: 0, baseSpeed: 2.7, stamina: 100, color: '#BC8F8F', jockey: 'ğŸ‘²', stats: { wins: 0, races: 0 } },
        { id: 7, name: 'Thunder Hoof', x: 50, y: 920, speed: 0, baseSpeed: 2.4, stamina: 100, color: '#A0522D', jockey: 'ğŸ§•', stats: { wins: 0, races: 0 } },
        { id: 8, name: 'Lightning Bolt', x: 50, y: 1040, speed: 0, baseSpeed: 3.2, stamina: 100, color: '#D2B48C', jockey: 'ğŸ‘±', stats: { wins: 0, races: 0 } }
      ],
      raceInProgress: false,
      winner: null,
      animationFrame: null,

      init(canvasId) {
        this.canvas = document.getElementById(canvasId);
        if (!this.canvas) return false;
        this.ctx = this.canvas.getContext('2d');
        if (!this.ctx) return false;
        this.generateObstacles();
        this.drawTrack();
        return true;
      },

      generateObstacles() {
        this.obstacles = [];
        const numObstacles = 15;
        for (let i = 0; i < numObstacles; i++) {
          this.obstacles.push({
            x: 200 + (i * 60) + Math.random() * 40,
            y: Math.random() * (this.canvas.height - 100),
            type: Math.random() > 0.5 ? 'cactus' : 'rock'
          });
        }
      },

      drawTrack() {
        const ctx = this.ctx;
        const canvas = this.canvas;

        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Different backgrounds for each track
        const trackColors = {
          arabian: { sky: '#87CEEB', sand1: '#F4A460', sand2: '#D2691E' },
          egyptian: { sky: '#FFE4B5', sand1: '#DEB887', sand2: '#8B7355' },
          sahara: { sky: '#FF6347', sand1: '#FF8C69', sand2: '#CD5C5C' }
        };

        const colors = trackColors[this.currentTrack];

        const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
        gradient.addColorStop(0, colors.sky);
        gradient.addColorStop(0.6, colors.sand1);
        gradient.addColorStop(1, colors.sand2);
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Draw lanes
        for (let i = 0; i < 10; i++) {
          ctx.strokeStyle = 'rgba(139, 69, 19, 0.3)';
          ctx.lineWidth = 2;
          ctx.setLineDash([10, 5]);
          ctx.beginPath();
          ctx.moveTo(0, i * 120);
          ctx.lineTo(canvas.width, i * 120);
          ctx.stroke();
          ctx.setLineDash([]);
        }

        // Draw obstacles
        this.obstacles.forEach(obs => {
          if (obs.type === 'cactus') {
            // Cactus
            ctx.fillStyle = '#2F4F2F';
            ctx.fillRect(obs.x, obs.y, 20, 40);
            ctx.fillRect(obs.x - 10, obs.y + 10, 15, 20);
            ctx.fillRect(obs.x + 15, obs.y + 15, 15, 15);
          } else {
            // Rock
            ctx.fillStyle = '#696969';
            ctx.beginPath();
            ctx.arc(obs.x, obs.y, 15, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#808080';
            ctx.beginPath();
            ctx.arc(obs.x + 5, obs.y - 5, 10, 0, Math.PI * 2);
            ctx.fill();
          }
        });

        // Draw finish line
        ctx.fillStyle = '#000';
        ctx.fillRect(canvas.width - 80, 0, 80, canvas.height);

        for (let i = 0; i < 20; i++) {
          for (let j = 0; j < 2; j++) {
            if ((i + j) % 2 === 0) {
              ctx.fillStyle = '#fff';
              ctx.fillRect(canvas.width - 80 + (j * 40), i * 60, 40, 60);
            }
          }
        }
      },

      drawCamel(camel) {
        const ctx = this.ctx;

        ctx.fillStyle = camel.color;
        ctx.fillRect(camel.x, camel.y, 60, 40);
        ctx.fillRect(camel.x + 50, camel.y - 20, 20, 30);
        ctx.fillRect(camel.x + 60, camel.y - 25, 15, 15);

        ctx.beginPath();
        ctx.arc(camel.x + 20, camel.y + 5, 15, Math.PI, 0);
        ctx.fill();
        ctx.beginPath();
        ctx.arc(camel.x + 40, camel.y + 5, 12, Math.PI, 0);
        ctx.fill();

        ctx.fillRect(camel.x + 10, camel.y + 40, 6, 20);
        ctx.fillRect(camel.x + 25, camel.y + 40, 6, 20);
        ctx.fillRect(camel.x + 40, camel.y + 40, 6, 20);
        ctx.fillRect(camel.x + 55, camel.y + 40, 6, 20);

        ctx.font = '30px Arial';
        ctx.fillText(camel.jockey, camel.x + 25, camel.y + 20);

        ctx.fillStyle = '#000';
        ctx.font = 'bold 12px Courier New';
        ctx.fillText(camel.name, camel.x, camel.y - 35);
      },

      startRace() {
        if (this.raceInProgress) return false;

        this.camels.forEach(camel => {
          camel.x = 50;
          camel.speed = camel.baseSpeed;
          camel.stamina = 100;
        });

        this.generateObstacles();
        this.raceInProgress = true;
        this.winner = null;
        this.animate();
        return true;
      },

      checkObstacleCollision(camel) {
        for (let obs of this.obstacles) {
          const distance = Math.sqrt(
            Math.pow(camel.x + 30 - obs.x, 2) +
            Math.pow(camel.y + 20 - obs.y, 2)
          );
          if (distance < 35) {
            return true;
          }
        }
        return false;
      },

      animate() {
        if (!this.raceInProgress) return;

        this.drawTrack();

        let raceFinished = false;

        this.camels.forEach(camel => {
          // Base speed with variation
          const speedVariation = (Math.random() - 0.5) * 0.8;
          camel.speed = camel.baseSpeed + speedVariation;

          // Stamina effect (gets slower over time)
          camel.stamina -= 0.08;
          if (camel.stamina < 70) {
            camel.speed *= 0.97;
          }
          if (camel.stamina < 40) {
            camel.speed *= 0.93;
          }
          if (camel.stamina < 20) {
            camel.speed *= 0.88;
          }

          // Obstacle collision slows down
          if (this.checkObstacleCollision(camel)) {
            camel.speed *= 0.6;
          }

          // Terrain difficulty based on track
          const terrainMultiplier = {
            arabian: 1.0,
            egyptian: 0.95,
            sahara: 0.92
          };
          camel.speed *= terrainMultiplier[this.currentTrack];

          // Random burst of energy
          if (Math.random() > 0.98) {
            camel.speed *= 1.3;
          }

          camel.x += camel.speed;
          this.drawCamel(camel);

          if (camel.x >= this.canvas.width - 150 && !this.winner) {
            this.winner = camel;
            raceFinished = true;
          }
        });

        if (raceFinished) {
          this.finishRace();
        } else {
          this.animationFrame = requestAnimationFrame(() => this.animate());
        }
      },

      finishRace() {
        this.raceInProgress = false;

        if (this.animationFrame) {
          cancelAnimationFrame(this.animationFrame);
          this.animationFrame = null;
        }

        if (this.winner) {
          this.winner.stats.wins++;
          this.camels.forEach(c => c.stats.races++);

          this.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
          this.ctx.fillRect(250, 450, 700, 150);

          this.ctx.fillStyle = '#FFD700';
          this.ctx.font = 'bold 48px Courier New';
          this.ctx.textAlign = 'center';
          this.ctx.fillText('ğŸ† WINNER! ğŸ†', this.canvas.width / 2, 510);

          this.ctx.fillStyle = '#FFF';
          this.ctx.font = 'bold 32px Courier New';
          this.ctx.fillText(this.winner.name, this.canvas.width / 2, 560);

          return this.winner;
        }
      },

      stopRace() {
        this.raceInProgress = false;
        if (this.animationFrame) {
          cancelAnimationFrame(this.animationFrame);
          this.animationFrame = null;
        }
      }
    };

    function enterTent(tentName) {
      document.getElementById('village').style.display = 'none';
      document.querySelectorAll('.game-screen').forEach(s => s.classList.remove('active'));
      document.getElementById(`screen-${tentName}`).classList.add('active');

      if (tentName === 'racing') {
        setTimeout(() => {
          RaceEngine.init('raceCanvas');
        }, 100);
      }

      if (tentName === 'stable') {
        const listDiv = document.getElementById('camelList');
        listDiv.innerHTML = RaceEngine.camels.map(c => `
          <div style="background: rgba(139, 69, 19, 0.3); padding: 20px; border-radius: 10px; border: 2px solid #654321;">
            <h3 style="color: #FFD700;">${c.jockey} ${c.name}</h3>
            <p style="color: #FFF;">Speed: ${c.baseSpeed.toFixed(1)}</p>
            <p style="color: #FFF;">Wins: ${c.stats.wins} / ${c.stats.races}</p>
          </div>
        `).join('');
      }
    }

    function returnToVillage() {
      document.querySelectorAll('.game-screen').forEach(s => s.classList.remove('active'));
      document.getElementById('village').style.display = 'grid';
    }

    function startRace() {
      const statusDiv = document.getElementById('raceStatus');
      if (RaceEngine.raceInProgress) {
        statusDiv.textContent = 'âš ï¸ Race already in progress!';
        return;
      }

      statusDiv.textContent = 'ğŸ Race starting... GO GO GO!';
      RaceEngine.startRace();
      setTimeout(checkRaceResult, 100);
    }

    function resetRace() {
      RaceEngine.stopRace();
      RaceEngine.init('raceCanvas');
      document.getElementById('raceStatus').textContent = 'Race reset! Click START RACE to begin.';
    }

    function checkRaceResult() {
      if (!RaceEngine.raceInProgress && RaceEngine.winner) {
        document.getElementById('raceStatus').innerHTML = `
          ğŸ† <span style="color: #32CD32;">${RaceEngine.winner.name}</span> WINS! ğŸ†<br>
          <span style="font-size: 0.8em;">Jockey: ${RaceEngine.winner.jockey}</span>
        `;
      } else if (RaceEngine.raceInProgress) {
        setTimeout(checkRaceResult, 100);
      }
    }

    function selectLocation(location, element) {
      document.querySelectorAll('.location-card').forEach(card => {
        card.classList.remove('selected');
      });
      element.classList.add('selected');
      RaceEngine.currentTrack = location;

      const trackNames = {
        'arabian': 'ğŸœï¸ Arabian Sands',
        'egyptian': 'ğŸ›ï¸ Egyptian Pyramids',
        'sahara': 'ğŸŒ… Sahara Sunset'
      };

      document.getElementById('trackName').textContent = 'ğŸ“ ' + trackNames[location];

      // Redraw track with new theme
      if (document.getElementById('screen-racing').classList.contains('active')) {
        RaceEngine.init('raceCanvas');
      }
    }
  </script>
</body>
</html>

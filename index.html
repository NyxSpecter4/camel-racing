<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸœï¸ Desert Tribe - Camel Racing</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Courier New', monospace;
      background: linear-gradient(to bottom, #f4a460 0%, #daa520 50%, #d2691e 100%);
      min-height: 100vh;
      overflow-x: hidden;
    }
    .container { max-width: 1400px; margin: 0 auto; padding: 20px; text-align: center; }
    .title {
      color: #fff;
      text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.5);
      margin: 40px 0;
      animation: fadeIn 1s ease-in;
    }
    .title h1 { font-size: 3em; letter-spacing: 3px; }
    .title p { font-size: 1.2em; color: #ffe4b5; margin-top: 10px; }
    .village {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 30px;
      margin: 60px auto;
    }
    .tent {
      background: rgba(139, 69, 19, 0.8);
      border: 3px solid #654321;
      border-radius: 15px;
      padding: 30px 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
      min-height: 200px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .tent:hover {
      transform: translateY(-10px) scale(1.05);
      background: rgba(139, 69, 19, 0.95);
    }
    .tent::before {
      content: 'â›º';
      font-size: 4em;
      display: block;
      margin-bottom: 10px;
    }
    .tent h2 {
      color: #ffe4b5;
      font-size: 1.5em;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }
    .tent p { color: #ffd700; font-size: 0.9em; }
    .game-screen {
      display: none;
      background: rgba(0, 0, 0, 0.8);
      border: 4px solid #654321;
      border-radius: 15px;
      padding: 30px;
      margin: 20px auto;
      max-width: 1300px;
      min-height: 500px;
      color: #fff;
    }
    .game-screen.active { display: block; }
    .game-screen h2 {
      color: #ffd700;
      font-size: 2em;
      margin-bottom: 20px;
      text-align: center;
    }
    .back-button {
      background: linear-gradient(45deg, #8B4513, #654321);
      color: #fff;
      border: none;
      padding: 12px 24px;
      font-size: 1em;
      font-weight: bold;
      border-radius: 8px;
      cursor: pointer;
      margin-bottom: 20px;
    }
    .back-button:hover { transform: scale(1.05); }
    button {
      background: linear-gradient(45deg, #32CD32, #228B22);
      color: white;
      border: none;
      padding: 15px 40px;
      font-size: 1.2em;
      font-weight: bold;
      border-radius: 8px;
      cursor: pointer;
      margin: 10px;
    }
    button:hover { transform: scale(1.05); }
    .camel-btn {
      background: linear-gradient(45deg, #8B4513, #654321);
      padding: 10px 20px;
      font-size: 0.9em;
      margin: 5px;
    }
    .camel-btn.selected {
      background: linear-gradient(45deg, #32CD32, #228B22);
      box-shadow: 0 0 15px #32CD32;
    }
    canvas {
      background: #f0e68c;
      border: 4px solid #654321;
      border-radius: 10px;
      display: block;
      margin: 20px auto;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }
    #raceStatus {
      color: #FFD700;
      font-size: 1.3em;
      font-weight: bold;
      margin: 20px 0;
      padding: 15px;
      background: rgba(0,0,0,0.5);
      border-radius: 8px;
      min-height: 50px;
    }
    .player-section {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin: 20px 0;
    }
    .player-box {
      background: rgba(139, 69, 19, 0.4);
      padding: 20px;
      border-radius: 10px;
      border: 2px solid #654321;
    }
    .player-box h3 {
      color: #FFD700;
      margin-bottom: 15px;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="title">
      <h1>ğŸœï¸ DESERT TRIBE ğŸª</h1>
      <p>Welcome to the Ancient Camel Racing Grounds</p>
    </div>

    <div id="village" class="village">
      <div class="tent" onclick="enterTent('racing')">
        <h2>Racing Arena</h2>
        <p>Watch 9 camels race together!</p>
      </div>
      <div class="tent" onclick="enterTent('stable')">
        <h2>Camel Stable</h2>
        <p>Meet your 9 camels</p>
      </div>
      <div class="tent" onclick="enterTent('betting')">
        <h2>Betting Tent</h2>
        <p>Place your bets</p>
      </div>
      <div class="tent" onclick="enterTent('market')">
        <h2>Trader's Market</h2>
        <p>Buy gear</p>
      </div>
    </div>

    <div id="screen-racing" class="game-screen">
      <button class="back-button" onclick="returnToVillage()">â† Back to Village</button>
      <h2>ğŸ Racing Arena ğŸ</h2>
      <p style="color: #32CD32; font-size: 1.2em;">ğŸœï¸ Sand Dunes Track - All Camels Race Together!</p>

      <div class="player-section">
        <div class="player-box">
          <h3>ğŸ‘¤ PLAYER 1 - Pick Your Camel:</h3>
          <div id="player1Picks"></div>
          <p id="player1Choice" style="color: #32CD32; margin-top: 10px; font-weight: bold;"></p>
        </div>
        <div class="player-box">
          <h3>ğŸ‘¤ PLAYER 2 - Pick Your Camel:</h3>
          <div id="player2Picks"></div>
          <p id="player2Choice" style="color: #32CD32; margin-top: 10px; font-weight: bold;"></p>
        </div>
      </div>

      <canvas id="raceCanvas" width="1200" height="700"></canvas>
      <div>
        <button onclick="startRace()">ğŸ START RACE</button>
        <button onclick="resetRace()" style="background: linear-gradient(45deg, #FF6347, #DC143C);">ğŸ”„ RESET</button>
      </div>
      <div id="raceStatus">Each player pick a camel, then START RACE!</div>
    </div>

    <div id="screen-stable" class="game-screen">
      <button class="back-button" onclick="returnToVillage()">â† Back to Village</button>
      <h2>ğŸª Camel Stable ğŸª</h2>
      <div id="camelList" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;"></div>
    </div>

    <div id="screen-betting" class="game-screen">
      <button class="back-button" onclick="returnToVillage()">â† Back to Village</button>
      <h2>ğŸ’° Betting Tent ğŸ’°</h2>
      <p style="color: #ffd700;">Coming soon! Place bets and win big!</p>
    </div>

    <div id="screen-market" class="game-screen">
      <button class="back-button" onclick="returnToVillage()">â† Back to Village</button>
      <h2>ğŸ›’ Trader's Market ğŸ›’</h2>
      <p style="color: #ffd700;">Coming soon! Buy gear and upgrades!</p>
    </div>
  </div>

  <script>
    const GameState = {
      player1Pick: null,
      player2Pick: null
    };

    const RaceEngine = {
      canvas: null,
      ctx: null,
      camels: [
        { id: 0, name: 'Desert Storm', x: 50, y: 300, speed: 0, baseSpeed: 2.8, stamina: 100, color: '#8B4513', jockey: 'ğŸ‘³', stats: { wins: 0, races: 0 } },
        { id: 1, name: 'Sand Runner', x: 50, y: 320, speed: 0, baseSpeed: 2.5, stamina: 100, color: '#D2691E', jockey: 'ğŸ§”', stats: { wins: 0, races: 0 } },
        { id: 2, name: 'Golden Wind', x: 50, y: 280, speed: 0, baseSpeed: 3.0, stamina: 100, color: '#DAA520', jockey: 'ğŸ‘¨', stats: { wins: 0, races: 0 } },
        { id: 3, name: 'Oasis King', x: 50, y: 340, speed: 0, baseSpeed: 2.6, stamina: 100, color: '#CD853F', jockey: 'ğŸ§‘', stats: { wins: 0, races: 0 } },
        { id: 4, name: 'Dune Dancer', x: 50, y: 310, speed: 0, baseSpeed: 2.9, stamina: 100, color: '#DEB887', jockey: 'ğŸ‘´', stats: { wins: 0, races: 0 } },
        { id: 5, name: 'Mirage Master', x: 50, y: 290, speed: 0, baseSpeed: 3.1, stamina: 100, color: '#F4A460', jockey: 'ğŸ§“', stats: { wins: 0, races: 0 } },
        { id: 6, name: 'Swift Sands', x: 50, y: 330, speed: 0, baseSpeed: 2.7, stamina: 100, color: '#BC8F8F', jockey: 'ğŸ‘²', stats: { wins: 0, races: 0 } },
        { id: 7, name: 'Thunder Hoof', x: 50, y: 350, speed: 0, baseSpeed: 2.4, stamina: 100, color: '#A0522D', jockey: 'ğŸ§•', stats: { wins: 0, races: 0 } },
        { id: 8, name: 'Lightning Bolt', x: 50, y: 270, speed: 0, baseSpeed: 3.2, stamina: 100, color: '#D2B48C', jockey: 'ğŸ‘±', stats: { wins: 0, races: 0 } }
      ],
      raceInProgress: false,
      winner: null,
      animationFrame: null,

      init(canvasId) {
        this.canvas = document.getElementById(canvasId);
        if (!this.canvas) return false;
        this.ctx = this.canvas.getContext('2d');
        if (!this.ctx) return false;
        this.drawTrack();
        return true;
      },

      drawTrack() {
        const ctx = this.ctx;
        const canvas = this.canvas;

        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Sky gradient
        const skyGradient = ctx.createLinearGradient(0, 0, 0, canvas.height * 0.4);
        skyGradient.addColorStop(0, '#87CEEB');
        skyGradient.addColorStop(1, '#F4A460');
        ctx.fillStyle = skyGradient;
        ctx.fillRect(0, 0, canvas.width, canvas.height * 0.4);

        // Sand dunes - wavy terrain
        ctx.fillStyle = '#F4A460';
        ctx.beginPath();
        ctx.moveTo(0, canvas.height * 0.4);
        for (let x = 0; x < canvas.width; x += 20) {
          const y = canvas.height * 0.4 + Math.sin(x * 0.02) * 30 + 50;
          ctx.lineTo(x, y);
        }
        ctx.lineTo(canvas.width, canvas.height);
        ctx.lineTo(0, canvas.height);
        ctx.closePath();
        ctx.fill();

        // Second dune layer
        ctx.fillStyle = '#D2691E';
        ctx.beginPath();
        ctx.moveTo(0, canvas.height * 0.6);
        for (let x = 0; x < canvas.width; x += 20) {
          const y = canvas.height * 0.6 + Math.sin(x * 0.03 + 2) * 25 + 30;
          ctx.lineTo(x, y);
        }
        ctx.lineTo(canvas.width, canvas.height);
        ctx.lineTo(0, canvas.height);
        ctx.closePath();
        ctx.fill();

        // Draw sun
        ctx.fillStyle = '#FFD700';
        ctx.beginPath();
        ctx.arc(100, 100, 50, 0, Math.PI * 2);
        ctx.fill();

        // Draw finish line
        ctx.fillStyle = '#000';
        ctx.fillRect(canvas.width - 80, 0, 80, canvas.height);

        for (let i = 0; i < 12; i++) {
          for (let j = 0; j < 2; j++) {
            if ((i + j) % 2 === 0) {
              ctx.fillStyle = '#fff';
              ctx.fillRect(canvas.width - 80 + (j * 40), i * 60, 40, 60);
            }
          }
        }
      },

      drawCamel(camel) {
        const ctx = this.ctx;

        ctx.fillStyle = camel.color;
        ctx.fillRect(camel.x, camel.y, 50, 35);
        ctx.fillRect(camel.x + 40, camel.y - 18, 18, 28);
        ctx.fillRect(camel.x + 50, camel.y - 22, 13, 13);

        ctx.beginPath();
        ctx.arc(camel.x + 18, camel.y + 5, 13, Math.PI, 0);
        ctx.fill();
        ctx.beginPath();
        ctx.arc(camel.x + 35, camel.y + 5, 10, Math.PI, 0);
        ctx.fill();

        ctx.fillRect(camel.x + 10, camel.y + 35, 5, 18);
        ctx.fillRect(camel.x + 22, camel.y + 35, 5, 18);
        ctx.fillRect(camel.x + 35, camel.y + 35, 5, 18);
        ctx.fillRect(camel.x + 47, camel.y + 35, 5, 18);

        ctx.font = '28px Arial';
        ctx.fillText(camel.jockey, camel.x + 20, camel.y + 18);

        ctx.fillStyle = '#000';
        ctx.font = 'bold 11px Courier New';
        ctx.fillText(camel.name, camel.x, camel.y - 30);

        // Highlight picked camels
        if (camel.id === GameState.player1Pick) {
          ctx.strokeStyle = '#00FF00';
          ctx.lineWidth = 3;
          ctx.strokeRect(camel.x - 5, camel.y - 35, 70, 90);
          ctx.fillStyle = '#00FF00';
          ctx.font = 'bold 14px Arial';
          ctx.fillText('P1', camel.x - 5, camel.y - 38);
        }
        if (camel.id === GameState.player2Pick) {
          ctx.strokeStyle = '#0000FF';
          ctx.lineWidth = 3;
          ctx.strokeRect(camel.x - 5, camel.y - 35, 70, 90);
          ctx.fillStyle = '#0000FF';
          ctx.font = 'bold 14px Arial';
          ctx.fillText('P2', camel.x + 55, camel.y - 38);
        }
      },

      startRace() {
        if (this.raceInProgress) return false;

        this.camels.forEach(camel => {
          camel.x = 50;
          camel.y = 250 + (Math.random() * 200);
          camel.speed = camel.baseSpeed;
          camel.stamina = 100;
        });

        this.raceInProgress = true;
        this.winner = null;
        this.animate();
        return true;
      },

      animate() {
        if (!this.raceInProgress) return;

        this.drawTrack();

        let raceFinished = false;

        this.camels.forEach(camel => {
          const speedVariation = (Math.random() - 0.5) * 1.0;
          camel.speed = camel.baseSpeed + speedVariation;

          camel.stamina -= 0.12;
          if (camel.stamina < 70) camel.speed *= 0.97;
          if (camel.stamina < 40) camel.speed *= 0.93;
          if (camel.stamina < 20) camel.speed *= 0.88;

          if (Math.random() > 0.98) camel.speed *= 1.4;

          // Slight vertical movement for realism
          camel.y += (Math.random() - 0.5) * 2;
          camel.y = Math.max(200, Math.min(500, camel.y));

          camel.x += camel.speed;

          this.drawCamel(camel);

          if (camel.x >= this.canvas.width - 150 && !this.winner) {
            this.winner = camel;
            raceFinished = true;
          }
        });

        if (raceFinished) {
          this.finishRace();
        } else {
          this.animationFrame = requestAnimationFrame(() => this.animate());
        }
      },

      finishRace() {
        this.raceInProgress = false;

        if (this.animationFrame) {
          cancelAnimationFrame(this.animationFrame);
          this.animationFrame = null;
        }

        if (this.winner) {
          this.winner.stats.wins++;
          this.camels.forEach(c => c.stats.races++);

          this.ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';
          this.ctx.fillRect(250, 250, 700, 200);

          this.ctx.fillStyle = '#FFD700';
          this.ctx.font = 'bold 48px Courier New';
          this.ctx.textAlign = 'center';
          this.ctx.fillText('ğŸ† WINNER! ğŸ†', this.canvas.width / 2, 310);

          this.ctx.fillStyle = '#FFF';
          this.ctx.font = 'bold 32px Courier New';
          this.ctx.fillText(this.winner.name + ' ' + this.winner.jockey, this.canvas.width / 2, 360);

          // Check multiplayer winners
          if (this.winner.id === GameState.player1Pick) {
            this.ctx.fillStyle = '#00FF00';
            this.ctx.font = 'bold 28px Courier New';
            this.ctx.fillText('ğŸ‰ PLAYER 1 WINS! ğŸ‰', this.canvas.width / 2, 410);
          } else if (this.winner.id === GameState.player2Pick) {
            this.ctx.fillStyle = '#0000FF';
            this.ctx.font = 'bold 28px Courier New';
            this.ctx.fillText('ğŸ‰ PLAYER 2 WINS! ğŸ‰', this.canvas.width / 2, 410);
          }

          return this.winner;
        }
      },

      stopRace() {
        this.raceInProgress = false;
        if (this.animationFrame) {
          cancelAnimationFrame(this.animationFrame);
          this.animationFrame = null;
        }
      }
    };

    function pickCamel(player, camelId) {
      if (player === 1) {
        GameState.player1Pick = camelId;
        document.getElementById('player1Choice').textContent = 'âœ“ Picked: ' + RaceEngine.camels[camelId].name;
      } else {
        GameState.player2Pick = camelId;
        document.getElementById('player2Choice').textContent = 'âœ“ Picked: ' + RaceEngine.camels[camelId].name;
      }
      updatePickButtons();
    }

    function updatePickButtons() {
      ['player1Picks', 'player2Picks'].forEach((id, player) => {
        const div = document.getElementById(id);
        div.innerHTML = RaceEngine.camels.map(c => {
          const isSelected = (player === 0 && GameState.player1Pick === c.id) ||
                            (player === 1 && GameState.player2Pick === c.id);
          return `<button class="camel-btn ${isSelected ? 'selected' : ''}"
                    onclick="pickCamel(${player + 1}, ${c.id})">
                    ${c.jockey} ${c.name}
                  </button>`;
        }).join('');
      });
    }

    function enterTent(tentName) {
      document.getElementById('village').style.display = 'none';
      document.querySelectorAll('.game-screen').forEach(s => s.classList.remove('active'));
      document.getElementById(`screen-${tentName}`).classList.add('active');

      if (tentName === 'racing') {
        setTimeout(() => {
          RaceEngine.init('raceCanvas');
          updatePickButtons();
        }, 100);
      }

      if (tentName === 'stable') {
        const listDiv = document.getElementById('camelList');
        listDiv.innerHTML = RaceEngine.camels.map(c => `
          <div style="background: rgba(139, 69, 19, 0.3); padding: 20px; border-radius: 10px; border: 2px solid #654321;">
            <h3 style="color: #FFD700;">${c.jockey} ${c.name}</h3>
            <p style="color: #FFF;">Speed: ${c.baseSpeed.toFixed(1)}</p>
            <p style="color: #FFF;">Wins: ${c.stats.wins} / ${c.stats.races}</p>
          </div>
        `).join('');
      }
    }

    function returnToVillage() {
      document.querySelectorAll('.game-screen').forEach(s => s.classList.remove('active'));
      document.getElementById('village').style.display = 'grid';
    }

    function startRace() {
      const statusDiv = document.getElementById('raceStatus');

      if (!GameState.player1Pick && !GameState.player2Pick) {
        statusDiv.textContent = 'âš ï¸ Players need to pick camels first!';
        return;
      }

      if (RaceEngine.raceInProgress) {
        statusDiv.textContent = 'âš ï¸ Race already in progress!';
        return;
      }

      statusDiv.textContent = 'ğŸ Race starting... GO GO GO!';
      RaceEngine.startRace();
      setTimeout(checkRaceResult, 100);
    }

    function resetRace() {
      RaceEngine.stopRace();
      RaceEngine.init('raceCanvas');
      GameState.player1Pick = null;
      GameState.player2Pick = null;
      document.getElementById('player1Choice').textContent = '';
      document.getElementById('player2Choice').textContent = '';
      document.getElementById('raceStatus').textContent = 'Each player pick a camel, then START RACE!';
      updatePickButtons();
    }

    function checkRaceResult() {
      if (!RaceEngine.raceInProgress && RaceEngine.winner) {
        const statusDiv = document.getElementById('raceStatus');
        let msg = `ğŸ† ${RaceEngine.winner.name} WINS! ğŸ†`;

        if (RaceEngine.winner.id === GameState.player1Pick) {
          msg += '<br><span style="color: #00FF00;">ğŸ‰ PLAYER 1 WINS! ğŸ‰</span>';
        } else if (RaceEngine.winner.id === GameState.player2Pick) {
          msg += '<br><span style="color: #0000FF;">ğŸ‰ PLAYER 2 WINS! ğŸ‰</span>';
        }

        statusDiv.innerHTML = msg;
      } else if (RaceEngine.raceInProgress) {
        setTimeout(checkRaceResult, 100);
      }
    }
  </script>
</body>
</html>
